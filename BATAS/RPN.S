CALL PUSH CS
CALL POP DS
CALL XOR CH CH
CALL MOV CL [WORD] 128
CALL MOV SI WORD 129

CALL LABEL RDLOOP
CALL LODSB

CALL CMP AL BYTE 48
CALL JL %TRYUNDER%
CALL CMP AL BYTE 57
CALL JA %TRYUNDER%
CALL SUB AL BYTE 48
CALL XOR AH AH
CALL MOV DI AX
CALL POP AX
CALL MOV DX WORD 10
CALL MUL DX
CALL ADD AX DI
CALL PUSH AX
CALL JMP %ENDLOOP%

CALL LABEL TRYUNDER
CALL CMP AL BYTE 95
CALL JNE %TRYPLUS%
CALL XOR AX AX
CALL PUSH AX
CALL JMP %ENDLOOP%

CALL LABEL TRYPLUS
CALL CMP AL BYTE 43
CALL JNE %TRYMINUS%
CALL POP AX
CALL POP DX
CALL ADD AX DX
CALL PUSH AX
CALL JMP %ENDLOOP%

CALL LABEL TRYMINUS
CALL CMP AL BYTE 45
CALL JNE %TRYTIMES%
CALL POP AX
CALL POP DX
CALL SUB DX AX
CALL PUSH DX
CALL JMP %ENDLOOP%

CALL LABEL TRYTIMES
CALL CMP AL BYTE 42
CALL JNE %TRYDIV%
CALL POP AX
CALL POP DX
CALL MUL DX
CALL PUSH AX
CALL JMP %ENDLOOP%

CALL LABEL TRYDIV
CALL CMP AL BYTE 47
CALL JNE %TRYMOD%
CALL POP DI
CALL POP AX
CALL XOR DX DX
CALL DIV DI
CALL PUSH AX
CALL JMP %ENDLOOP%

CALL LABEL TRYMOD
CALL CMP AL BYTE 35
CALL JNE %TRYGT%
CALL POP DI
CALL POP AX
CALL XOR DX DX
CALL DIV DI
CALL PUSH DX
CALL JMP %ENDLOOP%

CALL LABEL TRYGT
CALL CMP AL BYTE 63
CALL JNE %ENDLOOP%
CALL POP AX
CALL POP DX
CALL XOR DI DI
CALL CMP DX AX
CALL JNA %NOINC%
CALL INC DI
CALL LABEL NOINC
CALL PUSH DI
CALL JMP %ENDLOOP%

CALL LABEL ENDLOOP
CALL LOOP %RDLOOP%

CALL POP AX
CALL MOV CX WORD 65535
CALL PUSH CX
CALL LABEL DIVLOOP
CALL XOR DX DX
CALL MOV CX WORD 10
CALL DIV CX
CALL PUSH DX
CALL TEST AX AX
CALL JNZ %DIVLOOP%

CALL MOV DI WORD %STRNUM%

CALL LABEL REVLOOP
CALL POP AX
CALL CMP AX WORD 65535
CALL JE %REVOUT%
CALL ADD AL BYTE 48
CALL STOSB
CALL JMP %REVLOOP%

CALL LABEL REVOUT
CALL MOV [DI] BYTE 36
CALL MOV DX WORD %STR%
CALL MOV AH BYTE 9
CALL INT 33
CALL INT 32

CALL LABEL STR
CALL DB 83 69 84 32 82 69 83 85
CALL DB 76 84 61
CALL LABEL STRNUM
CALL DB 95 95 95 95 95 36

